# Copy this file to .env and set real values locally or via secret manager
DATABASE_URL="postgresql://DB_USER:DB_PASSWORD@localhost:5432/insidex?schema=public&connection_limit=10&pool_timeout=20&connect_timeout=10&sslmode=prefer"
DATABASE_SSL_MODE="prefer"

# JWT access token settings
JWT_ACCESS_SECRET="replace-with-a-strong-random-secret-min-32-chars"
JWT_ACCESS_ISSUER="insidex-auth"
JWT_ACCESS_AUDIENCE="insidex-api"
JWT_ACCESS_EXPIRY="15m"

# JWT refresh token settings
JWT_REFRESH_SECRET="replace-with-a-different-strong-random-secret-min-32-chars"
JWT_REFRESH_ISSUER="insidex-auth-refresh"
JWT_REFRESH_AUDIENCE="insidex-api-refresh"
JWT_REFRESH_EXPIRY="30m"

# Webhook security secrets
STRIPE_WEBHOOK_SECRET="whsec_replace_me"
STRIPE_WEBHOOK_TOLERANCE_SECONDS="300"
PAYPAL_WEBHOOK_SECRET="replace-me-paypal-shared-secret"
PAYPAL_WEBHOOK_ID="replace-me-paypal-webhook-id"
PAYMENT_WEBHOOK_SECRET="replace-me-internal-orders-webhook-secret"

# CORS whitelist (comma-separated origins)
# Example: CORS_ORIGIN="https://app.insidex.com,https://admin.insidex.com"
CORS_ORIGIN=""

# Redis rate limiting (required for distributed/multi-instance deployments)
REDIS_URL="redis://localhost:6379"
RATE_LIMIT_KEY_PREFIX="ratelimit"
RATE_LIMIT_TTL_JITTER_MS="250"

# Request payload limits (DoS / memory hardening)
JSON_BODY_LIMIT="1mb"
STRIPE_RAW_BODY_LIMIT="512kb"
PAYPAL_RAW_BODY_LIMIT="512kb"